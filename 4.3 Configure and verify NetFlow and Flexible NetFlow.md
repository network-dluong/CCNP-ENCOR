## NetFlow  
* Collects traffic based on flows (unidirectional traffic stream that contains combination of fields)  
* NetFlow Data Capture – captures traffic statistics  
* NetFlow Data Export – exports statistical data to a NetFlow collector  
* Example:  
> **ip flow-export version 9**  
> **ip flow-export destination (*ip address*)**  
> **int Eth(*#/#*)**  
> **ip flow ingress**  
> **ip flow egress**  
* To show interfaces that are configured with NetFlow:  
> **show ip flow interface**   
* To show destination for NetFlow data to be exported as well as statistics on export, including any errors:  
> **show ip flow export**  
* To show traffic flows that NetFlow is capturing:  
> **show ip cache flow**  
* More configurations:  
> **ip flow-top-talkers**  
> **top (1-200)**  
> **sort-by (*bytes/packets*)**  

## Flexible NetFlow  
* Aid in more complex traffic analysis configuration and allows for the use and reuse of configuration components  
* Multiple different flow policies can be applied to the same traffic as it flows through device  
* Can dynamically create individual caches for each type of flow  
* Can filter ingress traffic destined to a single destination  
* **Collect** – used to select non-key fields  
* **Match** – used to select key fields  
* To configure flow record:  
1. Define the flow record name:  
> **flow record (*name*)**  
2. Set a useful description of new flow record:  
> **description Custom Flow Record for IPv4 Traffic**  
3. Set match criteria for key fields:  
> **match ipv4 destination address**  
4. Define non-key fields to be collected:  
> **collect counter (*bytes/packets*)**  
5. To see all flow records configured and running configuration of the customer flow records that were created:  
> **show flow record (*name*)**  

## Building flow exporter:  
1. Define flow exporter name:  
> **flow exporter (*name*)**  
2. Set a useful description of the flow exporter:  
> **description EXPORT-TO-NETFLOW-COLLECTOR**  
3. Specify the destination of the flow exporter to be used:  
> **destination (*ip address*)**  
> **export-protocol netflow-v9**  
4. Specify the UDP port:  
> **transport UDP (*UDP-number*)**  

## Configure flow monitor:  
1. Define flow monitor name:  
> **flow monitor (*name*)**  
2. Set a useful description of flow monitor:  
> **description Uses Custom Flow Record CUSTOM1 for IPv4$**  
3. Specify the flow record to be used:  
> **record CUSTOM1**  
4. Specify a cache timeout of 60 for active connections:  
> **cache active timeout 60**  
5. Assign the exporter to the monitor:  
> **exporter CUSTOM1**  
6. Apply Netflow to interfaces:  
> **int eth(*#/#*)**  
> **ip flow monitor CUSTOM1 input**  


> *[Back](https://github.com/network-dluong/CCNP-ENCOR/tree/4.0-Network-Assurance)*  

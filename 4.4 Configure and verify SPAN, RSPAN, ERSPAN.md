### Switched Port Analyzer (SPAN)  
* Captures local network traffic on a switch and sends copy of network traffic to a local port attached to some sort of traffic analyzer  
* Local SPAN â€“ can only be one of the following: one or more specific switch ports; a port channel; a VLAN  
1. Specifying source ports:  
> **monitor session (*session-id*) source {interface (*int-id*) | vlan (*vlan-id*)} [rx|tx|both]**  
* rx = traffic received by source, tx = traffic sent by source, both = default  
2. Specify and filter trunk port as source port to capture traffic for all VLANs:  
> **monitor session (*session-id*) filter vlan (*range*)**  
3. Specifying destination ports global:  
> **monitor session (*session-id*) destination interface (*int-id*) [encapsulation replicate]**  

#### Example 1:  
> **monitor session 1 source interface gi1/0/1 - 2**  
> **monitor session 1 destination interface gi1/0/9**  
> **show monitor session local**  

#### Example 2:  
> **monitor session 1 source interface gi1/0/10**  
> **monitor session 1 destination interface gi1/0/9 encapsulation replicate**  
> **monitor session 1 filter vlan 123**  

#### RDP:  
> **monitor session (*session-id*) destination interface (*int-id*) ingress {dot1q vlan (*vlan-id*) | untagged vlan (*vlan-id*)}**  
> **monitor session 1 source interface gi1/0/1**  
> **monitor session 1 destination interface gi1/0/2 ingress untagged vlan 123**  


### Remote Switched Port Analyzer (RSPAN)
* Captures network traffic on a remote switch and sends copy of network traffic to local switch through Layer 2 (switching) toward a local port attached to some sort of traffic analyzer  
* Allows source ports to be located on one switch and destination port on a different switch  
* MAC addresses are not learned on ports associated with RSPAN VLAN  
* Traffic is flooded out all ports associated to RSPAN VLAN  
* VLAN is created and then identified as an RSPAN VLAN: **remote-span**  

#### Example:  
> **vlan 99**  
> **name RSPAN_VLAN**  
> **remote-span**  
#### Source and Destination:  
> **monitor session 1 source interface gi1/0/3**  
> **monitor session 1 destination remote vlan 99**  


### Encapsulated Remote Switched Port Analyzer (ERSPAN)  
* Captures network traffic on remote device and sends traffic to the local system through Layer 3 (routing) toward a local port attached to some sort of traffic analyzer  
* Large-scale WAN with multiple remote sites, able to do packet captures from anywhere that has IP connectivity  
1. Specifying source ports:  
> **monitor session (*span-session-number*) type erspan-source**  
> **description**  
> **source {interface (*int-id*) | vlan (*vlan-id*)}**   
> **no shutdown**  
2. Specifying destination ports:  
> **destination**  
> **ip address (*ip-address*)**  
> **erspan-id (*erspan-id*)**  
> **origin ip address (*origin-ip*)**  

#### Example:  
> **monitor session 1 type erspan-source**  
> **description SOURCE-PC-D-TRAFFIC**  
> **source interface GigabitEthernet 1/0/4 rx**  
> **filter vlan 34**  
> **no shutdown**  
> **destination**  
> **ip address 10.123.1.100**  
> **erspan-id 2**  
> **origin ip address 10.34.1.4**  
> **exit**  
> **erspan ttl 32**  
> **show monitor session erspan-source session**  



